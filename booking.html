<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√¨nh Minh Hotel - ƒê·∫∑t ph√≤ng & Thanh to√°n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --hotel-blue: #2c3e50; --hotel-gold: #c19b6c; }
        body { background-color: #f4f7f6; font-family: 'Segoe UI', sans-serif; }
        .navbar-hotel { background: var(--hotel-blue); color: white; padding: 15px; }
        .booking-card { border: none; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .btn-payment { background: var(--hotel-gold); color: white; border: none; font-weight: bold; }
        .btn-payment:hover { background: #b08a5b; color: white; }
        .price-summary { background: #fff9f0; border-radius: 10px; padding: 20px; }
        .step-icon { width: 40px; height: 40px; background: var(--hotel-blue); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; }
    </style>
</head>
<body>

<nav class="navbar-hotel d-flex justify-content-between align-items-center shadow-sm mb-4">
    <h4 class="m-0"><i class="fas fa-hotel me-2"></i> B√åNH MINH HOTEL</h4>
    <a href="index.html" class="text-white text-decoration-none"><i class="fas fa-arrow-left me-1"></i> Quay l·∫°i</a>
</nav>

<div class="container py-5">
    <div class="row">
        <div class="col-lg-8">
            <div class="card booking-card p-4 mb-4">
                <h5 class="fw-bold mb-4 text-uppercase"><i class="fas fa-user-edit me-2 text-primary"></i>Th√¥ng tin ƒë·∫∑t ph√≤ng</h5>
                <form id="bookingForm">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label small fw-bold">H·ªç v√† t√™n</label>
                            <input type="text" id="custName" class="form-control" placeholder="Nguy·ªÖn VƒÉn A" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold">S·ªë ƒëi·ªán tho·∫°i</label>
                            <input type="tel" id="custPhone" class="form-control" placeholder="090xxxxxxx" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold">Ng√†y nh·∫≠n ph√≤ng</label>
                            <input type="date" id="checkIn" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold">Ng√†y tr·∫£ ph√≤ng</label>
                            <input type="date" id="checkOut" class="form-control" required>
                        </div>
                        <div class="col-12">
                            <label class="form-label small fw-bold">Lo·∫°i ph√≤ng</label>
                            <select id="roomType" class="form-select">
                                <option value="1" data-price="500000">Standard Cozy - 500.000ƒë/ƒë√™m</option>
                                <option value="2" data-price="800000">Deluxe Ocean View - 800.000ƒë/ƒë√™m</option>
                                <option value="3" data-price="1500000">Executive Suite - 1.500.000ƒë/ƒë√™m</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>

            <div class="card booking-card p-4">
                <h5 class="fw-bold mb-4 text-uppercase"><i class="fas fa-credit-card me-2 text-success"></i>Ph∆∞∆°ng th·ª©c thanh to√°n</h5>
                <div class="form-check mb-3 p-3 border rounded">
                    <input class="form-check-input ms-0 me-3" type="radio" name="payment" id="payBank" checked>
                    <label class="form-check-label d-flex align-items-center" for="payBank">
                        <i class="fas fa-university me-2 fa-lg text-primary"></i> Chuy·ªÉn kho·∫£n ng√¢n h√†ng (QR Code)
                    </label>
                </div>
                <div class="form-check p-3 border rounded">
                    <input class="form-check-input ms-0 me-3" type="radio" name="payment" id="payHotel">
                    <label class="form-check-label d-flex align-items-center" for="payHotel">
                        <i class="fas fa-money-bill-wave me-2 fa-lg text-success"></i> Thanh to√°n t·∫°i qu·∫ßy
                    </label>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card booking-card p-4 sticky-top" style="top: 20px;">
                <h5 class="fw-bold mb-4 border-bottom pb-2">T·ªîNG K·∫æT CHI PH√ç</h5>
                <div id="summary">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-muted">ƒê∆°n gi√°:</span>
                        <span id="sumPrice">0ƒë</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-muted">S·ªë ƒë√™m:</span>
                        <span id="sumNights">0 ƒë√™m</span>
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between fw-bold fs-4 mb-4">
                        <span>Th√†nh ti·ªÅn:</span>
                        <span id="sumTotal" class="text-danger">0ƒë</span>
                    </div>
                    <button class="btn btn-payment btn-lg w-100 shadow" id="btnConfirm">
                        X√ÅC NH·∫¨N ƒê·∫∂T PH√íNG
                    </button>
                    <p class="text-center small text-muted mt-3">ƒê·∫£m b·∫£o gi√° t·ªët nh·∫•t t·∫°i B√¨nh Minh Hotel</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    function calculateTotal() {
    const pricePerNight = parseInt(
        $("#roomType option:selected").data("price")
    );

    const start = new Date($('#checkIn').val());
    const end   = new Date($('#checkOut').val());

    if (start && end && end > start) {
        const nights = Math.ceil((end - start) / (1000*60*60*24));
        const total  = nights * pricePerNight;

        $('#sumPrice').text(pricePerNight.toLocaleString() + 'ƒë');
        $('#sumNights').text(nights + ' ƒë√™m');
        $('#sumTotal').text(total.toLocaleString() + 'ƒë');

        return total;
    }
    return 0;
}


    $('input, select').on('change', calculateTotal);
        // Gi·∫£ l·∫≠p g·ª≠i d·ªØ li·ªáu l√™n server PHP/SQL
        $("#btnConfirm").click(function () {

    const total = calculateTotal();

    if (total === 0) {
        alert("Vui l√≤ng ch·ªçn ng√†y nh·∫≠n v√† tr·∫£ ph√≤ng h·ª£p l·ªá!");
        return;
    }

    $.ajax({
        url: "datphong_api.php?action=add",
        type: "POST",
        dataType: "json",
        data: {
            KhachHangID: 1, // TODO: l·∫•y t·ª´ session khi c√≥ login
            PhongID: $("#roomType").val(),
            NgayNhan: $("#checkIn").val(),
            NgayTra: $("#checkOut").val()
        },
        success: function (res) {
            if (res.status === "success") {
                alert("üéâ ƒê·∫∑t ph√≤ng th√†nh c√¥ng!");
                window.location.href = "index.html";
            } else {
                alert("‚ùå L·ªói: " + res.message);
            }
        },
        error: function () {
            alert("‚ùå Kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c server!");
        }
    });
});

    $(document).ready(function() {
    // L·∫•y th√¥ng tin t·ª´ URL
    const urlParams = new URLSearchParams(window.location.search);
    const roomName = urlParams.get('room');
    const roomPrice = urlParams.get('price');

    if (roomName) {
        // T·ª± ƒë·ªông ch·ªçn ƒë√∫ng option trong select
        $("#roomType option").filter(function() {
            return $(this).text().indexOf(roomName) !== -1;
        }).prop('selected', true);
        
        // C·∫≠p nh·∫≠t l·∫°i gi√° hi·ªÉn th·ªã ngay l·∫≠p t·ª©c
        calculateTotal(); 
    }
});
});
</script>
</body>
</html>